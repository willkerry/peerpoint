name: Integration Testing

on: deployment_status

jobs:
  cypress-run:
    if:
      github.event_name == 'deployment_status' &&
      github.event.deployment_status.state == 'success'

    runs-on: ubuntu-latest

    steps:
      - name: Checkout
      - uses: actions/checkout@v2

      - name: Cypress run
      - uses: cypress-io/github-action@v4
        with:
          browser: chrome
        env:
          CYPRESS_BASE_URL: ${{ github.event.deployment_status.target_url }}
